{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap e555ceb2f2355eeda746","webpack:///./src/main.js"],"names":["HasProperty","a","b","Object","prototype","hasOwnProperty","call","ToString","val","keys","reduce","str","Error","findMatch","errorsAllowed","longest","length","shortest","shortestIndex","errorsSoFar","lastError","i","lettersMatch","twoLettersFlippedAround","tooManyErrors","consecutiveErrors","BM25","inputOptions","defaultOptions","verbose","options","assign","optKeys","forEach","key","terms","documents","stopWords","step2list","step3list","c","v","C","V","mgr0","meq1","mgr1","s_v","log","W","w","toLowerCase","firstch","charAt","toUpperCase","substr","word","plurals","regex","test","replace","endsInEed","endsInEdOrIng","fp","exec","cvc","RegExp","stem","vowelInStem","regexes","transformations","transformation","endsInY","stemHasVowel","commonSuffixes","suffix","suffixes","transform","endsInE","cvcvc","cvcv","cvNn","endsInLL","text","keepStopWords","words","trim","split","join","map","stemmer","filter","indexOf","collection","then","Date","now","uniqueKey","indexOn","indexKeys","conflictingIndexOnAndIndexKeys","console","warning","Array","isArray","doc","tokens","all","tokenize","tokenObj","indexKey","tokenizedTerms","propBody","indexedProps","prop","index","tokenList","termCount","countObj","term","n","foundIn","query","weight","maxResults","Infinity","returnDocumentsOnly","splice","stripStopWords","indexedTokens","relevantTokens","push","relevance","token","match","parseFloat","toFixed","scaleRelevance","r","propKey","results","recorded","foundInKeys","keyParts","docKey","addedRelevance","inverseRelevance","Math","floor","scaledRelevance","unweightedRelevance","foundInProps","document","orderedResults","sort","A","B","limitedResults","idx","bm25"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"BM25\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"BM25\"] = factory();\n\telse\n\t\troot[\"BM25\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e555ceb2f2355eeda746","const HasProperty = ( a, b ) => Object.prototype.hasOwnProperty.call( a, b );\nconst ToString = ( val ) => {\n\n\tif ( typeof val === 'object' ) {\n\t\treturn Object.keys( val ).reduce( ( str, a ) => `${str} ${ToString( val[a] )}`, '' );\n\t}\n\n\tif ( typeof val !== 'string' ) {\n\t\tthrow new Error( `Object contains property with value: ${val} (type: ${typeof val})` );\n\t}\n\n\treturn val;\n\n};\n\nconst findMatch = ( a, b, errorsAllowed = 2 ) => {\n\n\tconst longest  = a.length > b.length ? a : b;\n\tconst shortest = longest === a ? b : a;\n\n\tlet shortestIndex = 0;\n\tlet errorsSoFar   = 0;\n\tlet lastError     = null;\n\n\tfor ( let i = 0; i < longest.length; i += 1 ) {\n\n\t\tconst lettersMatch = ( longest[i] === shortest[shortestIndex] );\n\n\t\t// if these letters match, look\n\t\t// at the next set of letters\n\t\tif ( lettersMatch ) {\n\n\t\t\tshortestIndex += 1;\n\n\t\t\t// unless of course, that was the last letter, in which\n\t\t\t// case, we found a match!\n\t\t\tif ( shortestIndex === shortest.length ) {\n\t\t\t\treturn i - ( shortest.length - 1 );\n\t\t\t}\n\n\t\t}\n\n\t\t// if they don't match\n\t\telse {\n\n\t\t\t// it's okay if we're still looking for\n\t\t\t// the start of the string\n\t\t\tif ( shortestIndex === 0 ) {\n\n\t\t\t\t// unless of course, the remainder of the long string is\n\t\t\t\t// shorter than the short string\n\t\t\t\tif ( longest.length - i < shortest.length ) {\n\t\t\t\t\treturn -1; // in that case, we know this isn't a match\n\t\t\t\t}\n\n\t\t\t\tcontinue; // eslint-disable-line\n\n\t\t\t}\n\n\t\t\t// if we're mid-string, record the error\n\t\t\terrorsSoFar += 1;\n\n\t\t\t// check if this and the last letter were flipped around\n\t\t\t// like this: something -> somtehing\n\t\t\tconst twoLettersFlippedAround = ( shortest[shortestIndex] === longest[i - 1] && shortest[shortestIndex - 1] === longest[i] ); // eslint-disable-line\n\n\t\t\t// if that's too many errors or it's a consecutive error that\n\t\t\t// wasn't caused by two letters being switched around\n\t\t\tconst tooManyErrors     = ( errorsSoFar > errorsAllowed );\n\t\t\tconst consecutiveErrors = ( lastError === ( i - 1 ) && !twoLettersFlippedAround );\n\t\t\tif ( tooManyErrors || consecutiveErrors ) {\n\n\t\t\t\t// restart looking for the beginning of the short string\n\t\t\t\t// within the long string from this point\n\t\t\t\tshortestIndex = 0;\n\t\t\t\terrorsSoFar   = 0;\n\n\t\t\t\t// unless of course, the remainder of the long string is\n\t\t\t\t// shorter than the short string\n\t\t\t\tif ( longest.length - i < shortest.length ) {\n\t\t\t\t\treturn -1; // in that case, we know this isn't a match\n\t\t\t\t}\n\n\t\t\t\tcontinue; // eslint-disable-line\n\n\t\t\t}\n\n\t\t\t// if that wasn't too many errors, just move on\n\t\t\t// to the next letter, but record when our last\n\t\t\t// error was\n\t\t\tshortestIndex++; // eslint-disable-line\n\t\t\tlastError = i;\n\n\t\t\t// unless that was the last letter in which case,\n\t\t\t// that's a match!\n\t\t\tif ( shortestIndex === shortest.length ) {\n\t\t\t\treturn i - ( shortest.length - 1 );\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// if we made it here somehow, it's not a match\n\treturn -1;\n\n};\n\nexport default class BM25 {\n\n\tconstructor( inputOptions ) {\n\n\t\t// define options\n\t\tconst defaultOptions = {\n\t\t\tverbose : false,\n\t\t};\n\n\t\tconst options = Object.assign( defaultOptions, inputOptions );\n\t\tconst optKeys = Object.keys( options );\n\n\t\t// set all options\n\t\toptKeys.forEach( ( key ) => {\n\t\t\tthis[key] = options[key];\n\t\t} );\n\n\t\t// prepare top level stuff\n\t\tthis.terms     = {};\n\t\tthis.documents = {};\n\n\t\t// stop words\n\t\tthis.stopWords = ['a', 'about', 'above', 'across', 'after', 'afterwards', 'again', 'against', 'all', 'almost', 'alone', 'along', 'already', 'also', 'although', 'always', 'am', 'among', 'amongst', 'amoungst', 'amount', 'an', 'and', 'another', 'any', 'anyhow', 'anyone', 'anything', 'anyway', 'anywhere', 'are', 'around', 'as', 'at', 'back', 'be', 'became', 'because', 'become', 'becomes', 'becoming', 'been', 'before', 'beforehand', 'behind', 'being', 'below', 'beside', 'besides', 'between', 'beyond', 'bill', 'both', 'bottom', 'but', 'by', 'call', 'can', 'cannot', 'cant', 'co', 'computer', 'con', 'could', 'couldnt', 'cry', 'de', 'describe', 'detail', 'do', 'done', 'down', 'due', 'during', 'each', 'eg', 'eight', 'either', 'eleven', 'else', 'elsewhere', 'empty', 'enough', 'etc', 'even', 'ever', 'every', 'everyone', 'everything', 'everywhere', 'except', 'few', 'fifteen', 'fify', 'fill', 'find', 'fire', 'first', 'five', 'for', 'former', 'formerly', 'forty', 'found', 'four', 'from', 'front', 'full', 'further', 'get', 'give', 'go', 'had', 'has', 'hasnt', 'have', 'he', 'hence', 'her', 'here', 'hereafter', 'hereby', 'herein', 'hereupon', 'hers', 'herse', '', 'him', 'himse', '', 'his', 'how', 'however', 'hundred', 'i', 'ie', 'if', 'in', 'inc', 'indeed', 'interest', 'into', 'is', 'it', 'its', 'itse', '', 'keep', 'last', 'latter', 'latterly', 'least', 'less', 'ltd', 'made', 'many', 'may', 'me', 'meanwhile', 'might', 'mill', 'mine', 'more', 'moreover', 'most', 'mostly', 'move', 'much', 'must', 'my', 'myse', '', 'name', 'namely', 'neither', 'never', 'nevertheless', 'next', 'nine', 'no', 'nobody', 'none', 'noone', 'nor', 'not', 'nothing', 'now', 'nowhere', 'of', 'off', 'often', 'on', 'once', 'one', 'only', 'onto', 'or', 'other', 'others', 'otherwise', 'our', 'ours', 'ourselves', 'out', 'over', 'own', 'part', 'per', 'perhaps', 'please', 'put', 'rather', 're', 'same', 'see', 'seem', 'seemed', 'seeming', 'seems', 'serious', 'several', 'she', 'should', 'show', 'side', 'since', 'sincere', 'six', 'sixty', 'so', 'some', 'somehow', 'someone', 'something', 'sometime', 'sometimes', 'somewhere', 'still', 'such', 'system', 'take', 'ten', 'than', 'that', 'the', 'their', 'them', 'themselves', 'then', 'thence', 'there', 'thereafter', 'thereby', 'therefore', 'therein', 'thereupon', 'these', 'they', 'thick', 'thin', 'third', 'this', 'those', 'though', 'three', 'through', 'throughout', 'thru', 'thus', 'to', 'together', 'too', 'top', 'toward', 'towards', 'twelve', 'twenty', 'two', 'un', 'under', 'until', 'up', 'upon', 'us', 'very', 'via', 'was', 'we', 'well', 'were', 'what', 'whatever', 'when', 'whence', 'whenever', 'where', 'whereafter', 'whereas', 'whereby', 'wherein', 'whereupon', 'wherever', 'whether', 'which', 'while', 'whither', 'who', 'whoever', 'whole', 'whom', 'whose', 'why', 'will', 'with', 'within', 'without', 'would', 'yet', 'you', 'your', 'yours', 'yourself', 'yourselves'];\n\n\t\t// all following stored here for\n\t\t// easier use by stemmer algorithm\n\t\tthis.step2list = {\n\t\t\t'ational' : 'ate',\n\t\t\t'tional'  : 'tion',\n\t\t\t'enci'    : 'ence',\n\t\t\t'anci'    : 'ance',\n\t\t\t'izer'    : 'ize',\n\t\t\t'bli'     : 'ble',\n\t\t\t'alli'    : 'al',\n\t\t\t'entli'   : 'ent',\n\t\t\t'eli'     : 'e',\n\t\t\t'ousli'   : 'ous',\n\t\t\t'ization' : 'ize',\n\t\t\t'ation'   : 'ate',\n\t\t\t'ator'    : 'ate',\n\t\t\t'alism'   : 'al',\n\t\t\t'iveness' : 'ive',\n\t\t\t'fulness' : 'ful',\n\t\t\t'ousness' : 'ous',\n\t\t\t'aliti'   : 'al',\n\t\t\t'iviti'   : 'ive',\n\t\t\t'biliti'  : 'ble',\n\t\t\t'logi'    : 'log'\n\t\t};\n\n\t\tthis.step3list = {\n\t\t\t'icate' : 'ic',\n\t\t\t'ative' : '',\n\t\t\t'alize' : 'al',\n\t\t\t'iciti' : 'ic',\n\t\t\t'ical'  : 'ic',\n\t\t\t'ful'   : '',\n\t\t\t'ness'  : ''\n\t\t};\n\n\t\t/* eslint-disable no-multi-spaces */\n\t\tthis.c = '[^aeiou]';               // consonant\n\t\tthis.v = '[aeiouy]';               // vowel\n\t\tthis.C = `${this.c}[^aeiouy]*`;    // consonant sequence\n\t\tthis.V = `${this.v}[aeiou]*`;      // vowel sequence\n\n\t\tthis.mgr0 = `^(${this.C})?${this.V}${this.C}`;                  // [C]VC... is m>0\n\t\tthis.meq1 = `^(${this.C})?${this.V}${this.C}(${this.V})?$`;     // [C]VC[V] is m=1\n\t\tthis.mgr1 = `^(${this.C})?${this.V}${this.C}${this.V}${this.C}`; // [C]VCVC... is m>1\n\t\tthis.s_v  = `^(${this.C})?${this.v}`;\n\t\t/* eslint-enable no-multi-spaces */\n\n\t}\n\n\tlog( ...args ) {\n\n\t\tif ( this.verbose ) {\n\t\t\tconsole.log( ...args );\n\t\t}\n\n\t}\n\n\tstemmer( W ) {\n\n\t\tlet w = W.toLowerCase(); // all to lower case (maybe bad)\n\n\t\tthis.log( `stemming word: ${W}` );\n\t\t// w cannot be condensed\n\t\tif ( w.length < 3 ) {\n\t\t\tthis.log( `${W} is very short, and cannot be stemmed` );\n\t\t\treturn w;\n\t\t}\n\n\t\tconst firstch = w.charAt( 0 );\n\n\t\t// y at beginning of word is always consonant\n\t\tif ( firstch === 'y' ) {\n\t\t\tthis.log( ' - Capitalizing first letter \"y\" so it won\\'t be caught by regexes' );\n\t\t\tw = firstch.toUpperCase() + w.substr( 1 );\n\t\t}\n\n\t\t// Step 1a - match plurals\n\t\tthis.log( `Step 1a : ${w}` );\n\t\tw = ( ( word ) => {\n\n\t\t\tconst plurals = [\n\t\t\t\t/^(.+?)(ss|i)es$i/,\n\t\t\t\t/^(.+?)([^s])s$/\n\t\t\t];\n\n\t\t\tfor ( let i = 0; i < plurals.length; i += 1 ) {\n\n\t\t\t\tconst regex = plurals[i];\n\n\t\t\t\tif ( regex.test( word ) ) {\n\t\t\t\t\treturn word.replace( regex, '$1$2' );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn word;\n\n\t\t} )( w );\n\n\t\t// Step 1b - determine tense\n\t\tthis.log( `Step 1b : ${w}` );\n\t\tw = ( ( word ) => {\n\n\t\t\tconst endsInEed     = /^(.+?)eed$/;\n\t\t\tconst endsInEdOrIng = /^(.+?)(ed|ing)$/;\n\n\t\t\t// present tense\n\t\t\tif ( endsInEed.test( word ) ) {\n\n\t\t\t\tconst fp  = endsInEed.exec( word );\n\t\t\t\tconst cvc = new RegExp( this.mgr0 ); // [C]VC this.mgr0 is from constructor\n\n\t\t\t\tif ( cvc.test( fp[1] ) ) {\n\t\t\t\t\treturn word.replace( /.$/, '' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// past or present progressive\n\t\t\telse if ( endsInEdOrIng.test( word ) ) {\n\t\t\t\tconst fp          = endsInEdOrIng.exec( word );\n\t\t\t\tconst stem        = fp[1];\n\t\t\t\tconst vowelInStem = new RegExp( this.s_v );\n\n\t\t\t\tif ( vowelInStem.test( stem ) ) {\n\n\t\t\t\t\tconst regexes = [\n\t\t\t\t\t\t/(at|bl|iz)$/,\n\t\t\t\t\t\tnew RegExp( '([^aeiouylsz])\\\\1$' ),\n\t\t\t\t\t\tnew RegExp( `^${this.C}${this.v}[^aeiouwxy]$` )\n\t\t\t\t\t];\n\n\t\t\t\t\tconst transformations = [\n\t\t\t\t\t\t( a => `${a}e` ),\n\t\t\t\t\t\t( a => a.replace( /.$/, '' ) ),\n\t\t\t\t\t\t( a => `${a}e` )\n\t\t\t\t\t];\n\n\t\t\t\t\tfor ( let i = 0; i < regexes.length; i += 1 ) {\n\t\t\t\t\t\tconst regex          = regexes[i];\n\t\t\t\t\t\tconst transformation = transformations[i];\n\n\t\t\t\t\t\tif ( regex.test( stem ) ) {\n\t\t\t\t\t\t\treturn transformation( stem );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn stem;\n\t\t\t}\n\n\t\t\treturn word;\n\t\t} )( w );\n\n\t\t// Step 1c - fix words ending in y (I think)\n\t\tthis.log( `Step 1c : ${w}` );\n\t\tw = ( ( word ) => {\n\t\t\tconst endsInY = /^(.+?)y$/;\n\t\t\tif ( endsInY.test( word ) ) {\n\t\t\t\tconst fp           = endsInY.exec( word );\n\t\t\t\tconst stem         = fp[1];\n\t\t\t\tconst stemHasVowel = new RegExp( this.s_v );\n\n\t\t\t\tif ( stemHasVowel.test( stem ) ) {\n\t\t\t\t\treturn `${stem}i`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn word;\n\t\t} )( w );\n\n\t\t// Step 2\n\t\tthis.log( `Step 2  : ${w}` );\n\t\tw = ( ( word ) => {\n\n\t\t\tconst commonSuffixes = /^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;\n\t\t\tif ( commonSuffixes.test( word ) ) {\n\t\t\t\tconst fp     = commonSuffixes.exec( word );\n\t\t\t\tconst stem   = fp[1];\n\t\t\t\tconst suffix = fp[2];\n\t\t\t\tconst cvc    = new RegExp( this.mgr0 ); // [C]VC\n\n\t\t\t\tif ( cvc.test( stem ) ) {\n\t\t\t\t\treturn `${stem}${this.step2list[suffix]}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn word;\n\n\t\t} )( w );\n\n\t\t// Step 3\n\t\tthis.log( `Step 3  : ${w}` );\n\t\tw = ( ( word ) => {\n\t\t\tconst suffixes = /^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;\n\t\t\tif ( suffixes.test( word ) ) {\n\t\t\t\tconst fp = suffixes.exec( w );\n\n\t\t\t\tconst stem   = fp[1];\n\t\t\t\tconst suffix = fp[2];\n\t\t\t\tconst cvc    = new RegExp( this.mgr0 );\n\n\t\t\t\tif ( cvc.test( stem ) ) {\n\t\t\t\t\treturn `${stem}${this.step3list[suffix]}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn word;\n\t\t} )( w );\n\n\t\t// Step 4\n\t\tthis.log( `Step 4  : ${w}` );\n\t\tw = ( ( word ) => {\n\t\t\tconst cvc      = new RegExp( this.mgr1 );\n\t\t\tconst suffixes = [\n\t\t\t\t{\n\t\t\t\t\tregex     : /^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,\n\t\t\t\t\ttransform : ( fp => `${fp[1]}` )\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tregex     : /^(.+?)(s|t)(ion)$/,\n\t\t\t\t\ttransform : ( fp => `${fp[1]}${fp[2]}` )\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tfor ( let i = 0; i < suffixes.length; i += 1 ) {\n\n\t\t\t\tconst suffix               = suffixes[i];\n\t\t\t\tconst { regex, transform } = suffix;\n\n\t\t\t\tif ( regex.test( word ) ) {\n\t\t\t\t\tconst fp   = regex.exec( word );\n\t\t\t\t\tconst stem = transform( fp );\n\n\t\t\t\t\tif ( cvc.test( stem ) ) {\n\t\t\t\t\t\treturn stem;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn word;\n\n\t\t} )( w );\n\n\t\t// Step 5\n\t\tthis.log( `Step 5  : ${w}` );\n\t\tw = ( ( word ) => {\n\t\t\tconst endsInE = /^(.+?)e$/;\n\t\t\tconst cvcvc   = new RegExp( this.mgr1 ); // [C]VCVC  is m > 1\n\n\t\t\tif ( endsInE.test( word ) ) {\n\t\t\t\tconst fp   = endsInE.exec( word );\n\t\t\t\tconst stem = fp[1];\n\n\t\t\t\tconst cvcv  = new RegExp( this.meq1 ); // [C]VC[V] is m = 1\n\t\t\t\tconst cvNn  = new RegExp( `^${this.C}${this.v}[^aeiouqxy]$` ); // CV doesn't end with aeiouqxy\n\n\t\t\t\tif ( ( cvcvc.test( stem ) || cvcv.test( stem ) ) && !( cvNn.test( stem ) ) ) {\n\t\t\t\t\treturn stem;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst endsInLL = /ll$/;\n\t\t\tif ( endsInLL.test( word ) && cvcvc.test( word ) ) {\n\t\t\t\treturn word.replace( endsInLL, '' );\n\t\t\t}\n\n\t\t\treturn word;\n\t\t} )( w );\n\n\t\tthis.log( `Step 6  : ${w}` );\n\t\t// and turn initial Y back to y\n\t\tif ( firstch === 'y' ) {\n\t\t\tw = firstch.toLowerCase() + w.substr( 1 );\n\t\t}\n\n\t\treturn w;\n\n\t}\n\n\ttokenize( text, keepStopWords = false ) {\n\n\t\tconst words = text\n\t\t\t.toLowerCase()\n\t\t\t.replace( /\\W/g, ' ' )\n\t\t\t.replace( /\\s+/g, ' ' )\n\t\t\t.trim()\n\t\t\t.split( ' ' );\n\n\t\tthis.log( `Tokenizing : [\"${words.join( '\", \"' )}\"]` );\n\t\tthis.log( `${keepStopWords ? 'keeping' : 'removing'} stop words` );\n\n\t\tif ( keepStopWords ) {\n\t\t\treturn words.map( a => this.stemmer( a ) );\n\t\t}\n\n\t\treturn words\n\t\t\t.filter( a => ( this.stopWords.indexOf( a ) === -1 ) )\n\t\t\t.map( a => this.stemmer( a ) );\n\n\t}\n\n\tindex( collection, inputOptions ) {\n\n\t\tconst then = Date.now();\n\n\t\t// set options\n\t\tconst options = Object.assign( {\n\t\t\tuniqueKey     : 'key',\n\t\t\tkeepStopWords : false, // whether to keep stop words such as prepositions\n\t\t\tindexOn       : 'all', // what keys to index on (this does NOT take a not of which tokens belong to which keys, but simplifies the process of creating a more precise index)\n\t\t\tindexKeys     : false, // what keys to index on (this *does* keep note of which tokens belong to which keys)\n\t\t}, inputOptions );\n\n\t\t// ensure options aren't inherently\n\t\t// goofed up\n\t\tconst conflictingIndexOnAndIndexKeys = ( options.indexOn !== 'all' && ( options.indexKeys !== false ) );\n\t\tif ( conflictingIndexOnAndIndexKeys ) {\n\t\t\tconsole.warning( 'Using the option \"indexKeys\" will overwrite any option specified by indexOn' );\n\t\t}\n\n\t\t// all a user to specify a single key to\n\t\t// indexOn as a string\n\t\tif ( typeof options.indexOn === 'string' && options.indexOn !== 'all' ) {\n\t\t\toptions.indexOn = [options.indexOn]; // ensure array\n\t\t}\n\n\t\t// allow options.indexKeys to be a string\n\t\tif ( typeof options.indexKeys === 'string' ) {\n\t\t\toptions.indexKeys = [options.indexKeys];\n\t\t}\n\n\t\tconst documents = ( () => {\n\t\t\tif ( Array.isArray( collection ) ) {\n\t\t\t\treturn collection.map( ( key, i ) => Object.assign( collection[i], { key } ) );\n\t\t\t}\n\n\t\t\tif ( typeof collection !== 'object' ) {\n\t\t\t\tthrow new Error( 'INDEXING ERROR: first parameter collection must be array or object' );\n\t\t\t}\n\n\t\t\treturn Object.keys( collection )\n\t\t\t\t.map( key => Object.assign( collection[key], { key } ) );\n\t\t} )();\n\n\t\tif ( this.verbose ) {\n\t\t\tconsole.log( `${then}: indexing ${documents.length} documents` );\n\t\t}\n\n\t\tdocuments.forEach( ( doc ) => {\n\n\t\t\t// remove uniqueKey from document\n\t\t\tconst key = doc[options.uniqueKey];\n\n\t\t\t// make sure that the key is a string\n\t\t\tif ( typeof key !== 'string' ) {\n\t\t\t\tthrow new Error( `Unique key must be string. Instead found: ${typeof key}` );\n\t\t\t}\n\n\t\t\t// cache the document for later\n\t\t\tthis.documents[key] = doc;\n\n\t\t\t// get an object patterned like\n\t\t\t// prop : tokens[]\n\t\t\tconst tokens = ( () => {\n\n\t\t\t\t// easy to tokenize a string\n\t\t\t\tif ( typeof doc === 'string' ) {\n\t\t\t\t\treturn { all : this.tokenize( doc, options.keepStopWords ) };\n\t\t\t\t}\n\n\t\t\t\t// determine which properties to\n\t\t\t\t// tokenize and\n\t\t\t\tif ( typeof doc === 'object' ) {\n\n\t\t\t\t\t// if we're indexing on all keys\n\t\t\t\t\t// then we can just make the object\n\t\t\t\t\t// into one string and tokenize that\n\t\t\t\t\tif ( options.indexOn === 'all' && !options.indexKeys ) {\n\n\t\t\t\t\t\tconst words = Object.keys( doc )\n\t\t\t\t\t\t\t.reduce( ( str, a ) => `${str}${doc[a]} `, '' );\n\n\t\t\t\t\t\treturn { all : this.tokenize( words, options.keepStopWords ) };\n\n\t\t\t\t\t}\n\n\t\t\t\t\telse if ( Array.isArray( options.indexOn ) && !options.indexKeys ) {\n\n\t\t\t\t\t\tconst words = Object.keys( doc )\n\t\t\t\t\t\t\t.filter( a => options.indexOn.indexOf( a ) !== -1 )\n\t\t\t\t\t\t\t.reduce( ( str, a ) => `${str}${doc[a]} `, '' );\n\n\t\t\t\t\t\treturn { all : this.tokenize( words, options.keepStopWords ) };\n\n\t\t\t\t\t}\n\n\t\t\t\t\telse if ( options.indexKeys !== false ) {\n\n\t\t\t\t\t\t// example:\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// options.indexOn = ['name', 'description'];\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// returns {\n\t\t\t\t\t\t//   name        : ['tokens', 'from', 'name'],\n\t\t\t\t\t\t//   description : ['tokens', 'in', 'description']\n\t\t\t\t\t\t// }\n\t\t\t\t\t\treturn options.indexKeys.reduce( ( tokenObj, indexKey ) => {\n\n\t\t\t\t\t\t\tconst tokenizedTerms = {};\n\t\t\t\t\t\t\tconst propBody       = ( () => {\n\t\t\t\t\t\t\t\tif ( typeof doc[indexKey] === 'string' ) {\n\t\t\t\t\t\t\t\t\treturn doc[indexKey];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ( typeof doc[indexKey] === 'object' ) {\n\t\t\t\t\t\t\t\t\treturn ToString( doc[indexKey] );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthrow new Error( 'Prop must be string or object' );\n\t\t\t\t\t\t\t} )();\n\n\t\t\t\t\t\t\ttokenizedTerms[indexKey]  = this.tokenize( propBody, options.keepStopWords );\n\n\t\t\t\t\t\t\treturn Object.assign( tokenObj, tokenizedTerms );\n\n\t\t\t\t\t\t}, {} );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// if the document isn't a string or an\n\t\t\t\t// object, then that's an error\n\t\t\t\tthrow new Error( 'First paramater doc must be string or object' );\n\n\t\t\t} )();\n\n\t\t\t// loop through each prop indexed,\n\t\t\t// if no properties have been specified\n\t\t\t// the prop will be 'all'\n\t\t\tconst indexedProps = Object.keys( tokens );\n\t\t\tindexedProps.forEach( ( prop ) => {\n\n\t\t\t\tconst index = ( prop === 'all' ? key : `${key}/${prop}` );\n\n\t\t\t\tconst tokenList = tokens[prop];\n\t\t\t\tconst termCount = tokenList.length;\n\n\t\t\t\tconst terms = tokenList.reduce( ( countObj, term ) => {\n\t\t\t\t\tif ( !HasProperty( countObj, term ) ) {\n\t\t\t\t\t\tcountObj[term] = 0; // eslint-disable-line\n\t\t\t\t\t}\n\n\t\t\t\t\tcountObj[term] += 1; // eslint-disable-line\n\n\t\t\t\t\treturn countObj;\n\t\t\t\t}, {} );\n\n\t\t\t\tObject.keys( terms ).forEach( ( term ) => {\n\n\t\t\t\t\tif ( !HasProperty( this.terms, term ) ) {\n\n\t\t\t\t\t\tthis.terms[term] = {\n\t\t\t\t\t\t\tn       : 0,\n\t\t\t\t\t\t\tfoundIn : {},\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.terms[term].n += 1;\n\t\t\t\t\tthis.terms[term].foundIn[index] = ( terms[term] / termCount );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t} );\n\n\t\tconst now = Date.now();\n\t\t// console.log( this.terms );\n\t\tif ( this.verbose ) {\n\t\t\tconsole.log( `${now}: done indexing after ${now - then}ms` );\n\t\t}\n\n\t}\n\n\tsearch( query, inputOptions ) {\n\n\t\tconst then = Date.now();\n\t\tconsole.log( `${then}: searching for: '${query}'` );\n\n\t\tconst options = Object.assign( {\n\t\t\tweight              : null,\n\t\t\tmaxResults          : Infinity,\n\t\t\treturnDocumentsOnly : true\n\t\t}, inputOptions );\n\n\t\tif ( query === '' ) {\n\n\t\t\tif ( options.maxResults === Infinity ) {\n\t\t\t\treturn this.documents;\n\t\t\t}\n\n\t\t\treturn this.documents.splice( 0, options.maxResults );\n\n\t\t}\n\n\t\tconst stripStopWords = ( query.split( / +/ ).length > 2 );\n\t\tconst tokenizedTerms = this.tokenize( query, stripStopWords );\n\t\tconst indexedTokens  = Object.keys( this.terms );\n\n\t\t// const recordedRelevant = {};\n\t\tconst relevantTokens   = [];\n\t\ttokenizedTerms.forEach( ( term ) => {\n\n\t\t\t// this is a perfect match\n\t\t\tif ( HasProperty( this.terms, term ) ) {\n\n\t\t\t\trelevantTokens.push( {\n\t\t\t\t\trelevance : 1,\n\t\t\t\t\tterm,\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\t// loop to check if this is\n\t\t\t// a partial match\n\t\t\tindexedTokens.forEach( ( token ) => {\n\n\t\t\t\t// don't try to find matches in cases where\n\t\t\t\t// the token is shorter than the search term\n\t\t\t\t// or where the token is identical to the term\n\t\t\t\tif ( token.length < term.length || ( token === term ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// find match\n\t\t\t\tconst match = findMatch( token, term );\n\t\t\t\tif ( match !== -1 ) {\n\n\t\t\t\t\t// match becomes increasingly less relevant the\n\t\t\t\t\t// smaller the term is compared to the token, and\n\t\t\t\t\t// also the further into the token the match is found\n\t\t\t\t\tconst relevance = parseFloat( ( ( term.length / ( token.length + match ) ) ** 2 ).toFixed( 3 ), 10 );\n\t\t\t\t\trelevantTokens.push( {\n\t\t\t\t\t\tterm : token,\n\t\t\t\t\t\trelevance\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t\t// scales relevance according to\n\t\t// prop used\n\n\t\tconst scaleRelevance = ( r, propKey ) => {\n\t\t\tif ( !propKey || options.weight === null ) {\n\t\t\t\treturn r;\n\t\t\t}\n\n\t\t\tif ( !HasProperty( options.weight, propKey ) ) {\n\t\t\t\treturn r;\n\t\t\t}\n\n\t\t\treturn options.weight[propKey] * r;\n\t\t};\n\n\t\t// loop through relevant tokens\n\t\t// to compile our results set\n\t\tconst results  = [];\n\t\tconst recorded = {};\n\t\trelevantTokens.forEach( ( token ) => {\n\n\t\t\tconst { term, relevance } = token;\n\t\t\tconst { foundIn } = this.terms[term];\n\n\t\t\t// search through all foundIn keys\n\t\t\t// for all matching tokens\n\t\t\tconst foundInKeys = Object.keys( foundIn );\n\t\t\tfoundInKeys.forEach( ( key ) => {\n\n\t\t\t\t// separate key into document key and property key\n\t\t\t\t// if there is no field, docKey will be the same\n\t\t\t\t// and propKey will be null\n\t\t\t\tconst keyParts = key.split( '/' );\n\t\t\t\tconst docKey   = keyParts[0];\n\t\t\t\tconst propKey  = keyParts.length > 1 ? keyParts[1] : null;\n\n\t\t\t\t// if we already recorded this document as a result\n\t\t\t\tif ( HasProperty( recorded, docKey ) ) {\n\t\t\t\t\tconst index = recorded[docKey];\n\t\t\t\t\tconst addedRelevance = ( () => {\n\t\t\t\t\t\tconst inverseRelevance = ( relevance - Math.floor( relevance ) );\n\n\t\t\t\t\t\tif ( inverseRelevance === 0 ) {\n\t\t\t\t\t\t\treturn 0.5;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn ( inverseRelevance ** 2 ); // eslint-disable-line\n\t\t\t\t\t} )();\n\n\t\t\t\t\t// increase the relevance of this search result\n\t\t\t\t\tresults[index].relevance       = parseFloat( results[index].relevance, 10 ) + addedRelevance;\n\t\t\t\t\tresults[index].scaledRelevance = parseFloat( results[index].scaledRelevance, 10 ) + scaleRelevance( addedRelevance, propKey );\n\n\t\t\t\t\t// make sure that there is place to put this term\n\t\t\t\t\tif ( !HasProperty( results[index].foundIn, propKey ) && propKey !== null ) {\n\t\t\t\t\t\tresults[index].foundIn[propKey] = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tresults[index].foundIn[propKey].push( term );\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst unweightedRelevance = ( parseFloat( foundIn[key], 10 ) + relevance );\n\n\t\t\t\tthis.log( `foundIn: ${foundIn[key]} relevance: ${relevance}` );\n\n\t\t\t\tconst foundInProps = {};\n\t\t\t\tfoundInProps[propKey] = [term];\n\n\t\t\t\trecorded[docKey] = results.length;\n\t\t\t\tresults.push( {\n\t\t\t\t\tdocument        : this.documents[docKey] || null,\n\t\t\t\t\tkey             : docKey,\n\t\t\t\t\tfoundIn         : foundInProps,\n\t\t\t\t\trelevance       : unweightedRelevance,\n\t\t\t\t\tscaledRelevance : scaleRelevance( unweightedRelevance ),\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t} );\n\n\t\tconst now = Date.now();\n\t\tconsole.log( `${now}: done searching after ${now - then}ms` );\n\n\t\tconst orderedResults = results.sort( ( a, b ) => {\n\t\t\tconst { scaledRelevance : A } = a;\n\t\t\tconst { scaledRelevance : B } = b;\n\n\t\t\treturn B - A;\n\t\t} );\n\n\t\tconst limitedResults = ( () => {\n\n\t\t\tif ( options.maxResults === Infinity ) {\n\t\t\t\treturn orderedResults;\n\t\t\t}\n\n\t\t\treturn orderedResults.splice( 0, 10 );\n\n\t\t} )();\n\n\t\tif ( options.returnDocumentsOnly ) {\n\t\t\treturn limitedResults.map( a => a.document );\n\t\t}\n\n\t\treturn limitedResults;\n\n\t}\n\n\tstatic fromIndex( idx ) {\n\t\tconst bm25 = new BM25();\n\n\t\tbm25.terms = idx;\n\n\t\treturn bm25;\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}